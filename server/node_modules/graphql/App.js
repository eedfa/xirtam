const express = require('express')
const graphqlHttp = require('express-graphql')
const userType = require('./schemas/userSchema.js')
const mongoose = require('mongoose')
const cors = require('cors')
const jwt = require('express-jwt')

const app = express()

app.use(cors())

const authMiddleware = jwt({ secret: 'jiodjwoijd9wjdopd203kJIO', credentialsRequired: false })
app.use(authMiddleware)
mongoose.connect('mongodb://a:aaaaaa1@ds125352.mlab.com:25352/wefewfwqasasf', { uri_decode_auth: true })
mongoose.connection.once('open', () => {
  console.log('connected')
})

app.use('/graphql', graphqlHttp({ schema: userType, graphiql: true }))

app.listen(4000, () => {
  console.log('UP!!!')
})
